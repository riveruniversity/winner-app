var T=Object.defineProperty;var S=(o,e,t)=>e in o?T(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var s=(o,e,t)=>S(o,typeof e!="symbol"?e+"":e,t);import{J as C,K as v,L as f,M as I,w,o as $}from"./BnDB5uks.js";function P(o){const e=document.cookie.match(new RegExp("(^| )"+o+"=([^;]+)"));return e?decodeURIComponent(e[2]):null}function O(o,e,t={}){const{expireDays:r=365,maxAge:a,path:l="/",domain:y,secure:m=!1,sameSite:_="Lax",httpOnly:p=!1}=t;let c=`${o}=${encodeURIComponent(e)}`;if(c+=`; path=${l}`,a!==void 0)c+=`; max-age=${a}`;else{const b=new Date(Date.now()+r*864e5).toUTCString();c+=`; expires=${b}`}y&&(c+=`; domain=${y}`),m&&(c+="; secure"),c+=`; samesite=${_}`,p&&(c+="; httponly"),document.cookie=c}function F(o,e={}){return o==="local"?{getItem:t=>localStorage.getItem(t),setItem:(t,r)=>localStorage.setItem(t,r)}:o==="session"?{getItem:t=>sessionStorage.getItem(t),setItem:(t,r)=>sessionStorage.setItem(t,r)}:{getItem:P,setItem:(t,r)=>O(t,r,e)}}function n(o,e,t={}){const{storage:r="local",serializer:a=JSON,syncTabs:l=!0,cookieExpireDays:y,cookieOptions:m={},onWriteError:_=console.error,onParseError:p=console.error,beforeRead:c=i=>i,beforeWrite:b=i=>i}=t,E={...m,...y!==void 0&&{expireDays:y}},g=typeof window<"u"&&typeof document<"u"?F(r,E):null;let D;try{const i=g==null?void 0:g.getItem(o);D=i?c(a.parse(i)):e}catch(i){p(i),D=e}let u=C(v(D));function k(i){try{const h=b(i);g==null||g.setItem(o,a.stringify(h))}catch(h){_(h)}}return l&&typeof window<"u"&&r==="local"&&window.addEventListener("storage",i=>{if(i.key===o&&i.storageArea===localStorage)try{const h=i.newValue?a.parse(i.newValue):e;f(u,c(h),!0)}catch(h){p(h)}}),I(()=>($(()=>{k(w(u))}),()=>{})),{get value(){return w(u)},set value(i){f(u,i,!0)},get current(){return w(u)},set current(i){f(u,i,!0)},reset(){f(u,e,!0)}}}const d="/api",L={lists:"listId",winners:"winnerId",prizes:"prizeId",history:"historyId",settings:"key",backups:"backupId",templates:"templateId",archive:"listId"};function W(o){return L[o]||"id"}class z{async fetch(e,t){const r=await fetch(e,{headers:{"Content-Type":"application/json",...t==null?void 0:t.headers},...t});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}async get(e,t){try{if(t){const a=`${d}/${e}/${t}`,l=await fetch(a);if(l.status===404)return null;if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return l.json()}const r=await fetch(`${d}/${e}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}catch(r){return console.error(`Error getting from ${e}:`,r),[]}}async getLists(){return await this.get("lists")}async getList(e){return await this.get("lists",e)}async getPrizes(){return await this.get("prizes")}async getPrize(e){return await this.get("prizes",e)}async getWinners(){return await this.get("winners")}async getWinner(e){return await this.get("winners",e)}async getHistory(){return await this.get("history")}async save(e,t){const r=W(e),a=t[r];if(!a)throw new Error(`Document must have a '${r}' field`);return(await this.fetch(`${d}/${e}`,{method:"POST",body:JSON.stringify(t)})).id||a}async delete(e,t){const r=await fetch(`${d}/${e}/${t}`,{method:"DELETE"});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return t}async updateWinner(e,t){const r=await this.getWinner(e);if(!r)throw new Error(`Winner ${e} not found`);const a={...r,...t};return await this.save("winners",a),a}async batchFetch(e){try{const t=await fetch(`${d}/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requests:e})});if(!t.ok)throw new Error(`Failed to batch fetch: ${t.statusText}`);return t.json()}catch(t){console.error("Error in batch fetch:",t);const r={};return e.forEach(a=>{r[a.collection]=[]}),r}}async batchSave(e){const t=await fetch(`${d}/batch-save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operations:e})});if(!t.ok)throw new Error(`Failed to batch save: ${t.statusText}`);return t.json()}async archiveList(e){const t=await this.getList(e);if(!t)throw new Error(`List ${e} not found`);const r={listId:t.listId,metadata:{...t.metadata},archivedAt:Date.now()};await this.save("archive",r),await this.delete("lists",e)}async saveSettings(e,t){await this.save("settings",{key:e,value:t,timestamp:Date.now()})}async checkHealth(){try{return(await fetch(`${d}/health`)).ok}catch{return!1}}}const R=new z;class x{constructor(){s(this,"_preventDuplicates",n("settings_preventDuplicates",!1));s(this,"_preventSamePrize",n("settings_preventSamePrize",!1));s(this,"_hideEntryCounts",n("settings_hideEntryCounts",!1));s(this,"_enableDebugLogs",n("settings_enableDebugLogs",!1));s(this,"_enableWebhook",n("settings_enableWebhook",!1));s(this,"_webhookUrl",n("settings_webhookUrl",""));s(this,"_fontFamily",n("settings_fontFamily","Open Sans"));s(this,"_primaryColor",n("settings_primaryColor","#6366f1"));s(this,"_secondaryColor",n("settings_secondaryColor","#8b5cf6"));s(this,"_selectionColor",n("settings_selectionColor","#10b981"));s(this,"_backgroundType",n("settings_backgroundType","gradient"));s(this,"_customBackgroundImage",n("settings_customBackgroundImage",null));s(this,"_selectionMode",n("settings_selectionMode","all-at-once"));s(this,"_displayEffect",n("settings_displayEffect","fade-in"));s(this,"_displayDuration",n("settings_displayDuration",.5));s(this,"_stableGrid",n("settings_stableGrid",!1));s(this,"_preSelectionDelay",n("settings_preSelectionDelay",0));s(this,"_delayVisualType",n("settings_delayVisualType","none"));s(this,"_soundDuringDelay",n("settings_soundDuringDelay","none"));s(this,"_soundEndOfDelay",n("settings_soundEndOfDelay","none"));s(this,"_soundDuringReveal",n("settings_soundDuringReveal","none"));s(this,"_celebrationEffect",n("settings_celebrationEffect","confetti"));s(this,"_celebrationDuration",n("settings_celebrationDuration",4));s(this,"_celebrationAutoTrigger",n("settings_celebrationAutoTrigger",!0));s(this,"_smsTemplate",n("settings_smsTemplate","Congratulations {name}! You won {prize}. Your code: {contactId}"))}get preventDuplicates(){return this._preventDuplicates.current}set preventDuplicates(e){this._preventDuplicates.current=e}get preventSamePrize(){return this._preventSamePrize.current}set preventSamePrize(e){this._preventSamePrize.current=e}get hideEntryCounts(){return this._hideEntryCounts.current}set hideEntryCounts(e){this._hideEntryCounts.current=e}get enableDebugLogs(){return this._enableDebugLogs.current}set enableDebugLogs(e){this._enableDebugLogs.current=e}get enableWebhook(){return this._enableWebhook.current}set enableWebhook(e){this._enableWebhook.current=e}get webhookUrl(){return this._webhookUrl.current}set webhookUrl(e){this._webhookUrl.current=e}get fontFamily(){return this._fontFamily.current}set fontFamily(e){this._fontFamily.current=e}get primaryColor(){return this._primaryColor.current}set primaryColor(e){this._primaryColor.current=e}get secondaryColor(){return this._secondaryColor.current}set secondaryColor(e){this._secondaryColor.current=e}get selectionColor(){return this._selectionColor.current}set selectionColor(e){this._selectionColor.current=e}get backgroundType(){return this._backgroundType.current}set backgroundType(e){this._backgroundType.current=e}get customBackgroundImage(){return this._customBackgroundImage.current}set customBackgroundImage(e){this._customBackgroundImage.current=e}get selectionMode(){return this._selectionMode.current}set selectionMode(e){this._selectionMode.current=e}get displayEffect(){return this._displayEffect.current}set displayEffect(e){this._displayEffect.current=e}get displayDuration(){return this._displayDuration.current}set displayDuration(e){this._displayDuration.current=e}get stableGrid(){return this._stableGrid.current}set stableGrid(e){this._stableGrid.current=e}get preSelectionDelay(){return this._preSelectionDelay.current}set preSelectionDelay(e){this._preSelectionDelay.current=e}get delayVisualType(){return this._delayVisualType.current}set delayVisualType(e){this._delayVisualType.current=e}get soundDuringDelay(){return this._soundDuringDelay.current}set soundDuringDelay(e){this._soundDuringDelay.current=e}get soundEndOfDelay(){return this._soundEndOfDelay.current}set soundEndOfDelay(e){this._soundEndOfDelay.current=e}get soundDuringReveal(){return this._soundDuringReveal.current}set soundDuringReveal(e){this._soundDuringReveal.current=e}get celebrationEffect(){return this._celebrationEffect.current}set celebrationEffect(e){this._celebrationEffect.current=e}get celebrationDuration(){return this._celebrationDuration.current}set celebrationDuration(e){this._celebrationDuration.current=e}get celebrationAutoTrigger(){return this._celebrationAutoTrigger.current}set celebrationAutoTrigger(e){this._celebrationAutoTrigger.current=e}get smsTemplate(){return this._smsTemplate.current}set smsTemplate(e){this._smsTemplate.current=e}applyTheme(){document.documentElement.style.setProperty("--bs-primary",this.primaryColor),document.documentElement.style.setProperty("--color-primary",this.primaryColor),document.documentElement.style.setProperty("--color-secondary",this.secondaryColor),document.documentElement.style.setProperty("--selection-color",this.selectionColor),document.documentElement.style.setProperty("--font-family",this.fontFamily),document.body.style.fontFamily=`'${this.fontFamily}', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif`}async saveSingleSetting(e,t){await R.saveSettings(e,t)}async saveMultipleSettings(e){for(const[t,r]of Object.entries(e))await this.saveSingleSetting(t,r)}getAllSettings(){return{preventDuplicates:this.preventDuplicates,preventSamePrize:this.preventSamePrize,hideEntryCounts:this.hideEntryCounts,enableDebugLogs:this.enableDebugLogs,enableWebhook:this.enableWebhook,webhookUrl:this.webhookUrl,fontFamily:this.fontFamily,primaryColor:this.primaryColor,secondaryColor:this.secondaryColor,selectionColor:this.selectionColor,backgroundType:this.backgroundType,customBackgroundImage:this.customBackgroundImage,selectionMode:this.selectionMode,displayEffect:this.displayEffect,displayDuration:this.displayDuration,stableGrid:this.stableGrid,preSelectionDelay:this.preSelectionDelay,delayVisualType:this.delayVisualType,soundDuringDelay:this.soundDuringDelay,soundEndOfDelay:this.soundEndOfDelay,soundDuringReveal:this.soundDuringReveal,celebrationEffect:this.celebrationEffect,celebrationDuration:this.celebrationDuration,celebrationAutoTrigger:this.celebrationAutoTrigger,smsTemplate:this.smsTemplate}}resetAll(){this._preventDuplicates.reset(),this._preventSamePrize.reset(),this._hideEntryCounts.reset(),this._enableDebugLogs.reset(),this._enableWebhook.reset(),this._webhookUrl.reset(),this._fontFamily.reset(),this._primaryColor.reset(),this._secondaryColor.reset(),this._selectionColor.reset(),this._backgroundType.reset(),this._customBackgroundImage.reset(),this._selectionMode.reset(),this._displayEffect.reset(),this._displayDuration.reset(),this._stableGrid.reset(),this._preSelectionDelay.reset(),this._delayVisualType.reset(),this._soundDuringDelay.reset(),this._soundEndOfDelay.reset(),this._soundDuringReveal.reset(),this._celebrationEffect.reset(),this._celebrationDuration.reset(),this._celebrationAutoTrigger.reset(),this._smsTemplate.reset()}}const B=new x;export{R as a,n as p,B as s};
